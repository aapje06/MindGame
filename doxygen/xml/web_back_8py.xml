<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.12">
  <compounddef id="web_back_8py" kind="file" language="Python">
    <compoundname>webBack.py</compoundname>
    <innerclass refid="classweb_back_1_1_server_sent_event" prot="public">webBack::ServerSentEvent</innerclass>
    <innernamespace refid="namespaceweb_back">webBack</innernamespace>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespaceweb_back" refkind="compound"><highlight class="keyword">import</highlight><highlight class="normal"><sp/>gevent</highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>gevent.wsgi<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>WSGIServer</highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>gevent.queue<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Queue</highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>time</highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>flask<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Flask,<sp/>Response,<sp/>send_from_directory,<sp/>request</highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>os.path</highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>MySQLdb</highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacegame_1_1game" kindref="compound">game.game</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Game</highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>__main__</highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>threading<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Thread</highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal">noFurtherRequests<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="comment">#<sp/>SSE<sp/>&quot;protocol&quot;<sp/>is<sp/>described<sp/>here:<sp/>http://mzl.la/UPFyxY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15" refid="classweb_back_1_1_server_sent_event" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classweb_back_1_1_server_sent_event" kindref="compound">ServerSentEvent</ref>(object):</highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classweb_back_1_1_server_sent_event_1a66ce128aaaf6596bbc7b0e6f3168de3f" kindref="member">__init__</ref>(self,<sp/>id,<sp/>event,<sp/>data,<sp/>retry):</highlight></codeline>
<codeline lineno="18"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classweb_back_1_1_server_sent_event_1a511ae0b1c13f95e5f08f1a0dd3da3d93" kindref="member">data</ref><sp/>=<sp/>data</highlight></codeline>
<codeline lineno="19"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classweb_back_1_1_server_sent_event_1a3b65133bb9997cd1ccf311af0927fc9e" kindref="member">event</ref><sp/>=<sp/>event</highlight></codeline>
<codeline lineno="20"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classweb_back_1_1_server_sent_event_1acf2488b95c97e0378c9bf49de3b50f28" kindref="member">id</ref><sp/>=<sp/>id</highlight></codeline>
<codeline lineno="21"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classweb_back_1_1_server_sent_event_1af6ce9532eff4ab447fa4598622e1c4f2" kindref="member">retry</ref><sp/>=<sp/>retry</highlight></codeline>
<codeline lineno="22"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classweb_back_1_1_server_sent_event_1a3f479e287873b8ab2327439f41a36969" kindref="member">desc_map</ref><sp/>=<sp/>{</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classweb_back_1_1_server_sent_event_1af6ce9532eff4ab447fa4598622e1c4f2" kindref="member">retry</ref><sp/>:<sp/></highlight><highlight class="stringliteral">&quot;retry&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classweb_back_1_1_server_sent_event_1acf2488b95c97e0378c9bf49de3b50f28" kindref="member">id</ref><sp/>:<sp/></highlight><highlight class="stringliteral">&quot;id&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classweb_back_1_1_server_sent_event_1a3b65133bb9997cd1ccf311af0927fc9e" kindref="member">event</ref><sp/>:<sp/></highlight><highlight class="stringliteral">&quot;event&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classweb_back_1_1_server_sent_event_1a511ae0b1c13f95e5f08f1a0dd3da3d93" kindref="member">data</ref><sp/>:<sp/></highlight><highlight class="stringliteral">&quot;data&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classweb_back_1_1_server_sent_event_1a4b60b01b4d79989f97d040a26388d852" kindref="member">encode</ref>(self):</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>self.<ref refid="classweb_back_1_1_server_sent_event_1a511ae0b1c13f95e5f08f1a0dd3da3d93" kindref="member">data</ref>:</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lines<sp/>=<sp/>[</highlight><highlight class="stringliteral">&quot;%s:<sp/>%s&quot;</highlight><highlight class="normal"><sp/>%<sp/>(v,<sp/>k)<sp/></highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>k,<sp/>v<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>self.<ref refid="classweb_back_1_1_server_sent_event_1a3f479e287873b8ab2327439f41a36969" kindref="member">desc_map</ref>.iteritems()<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>k]</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;%s\n\n&quot;</highlight><highlight class="normal"><sp/>%<sp/></highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">.join(lines)</highlight></codeline>
<codeline lineno="36"><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal">app<sp/>=<sp/>Flask(__name__,<sp/>static_url_path=</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,<sp/>static_path=</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">,static_folder=</highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight><highlight class="comment">#app.debug<sp/>=<sp/>True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="39"><highlight class="normal">app.debug<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal">app.use_reloader=</highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal">app.threaded<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal">@app.route(</highlight><highlight class="stringliteral">&apos;/css/&lt;path:path&gt;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespaceweb_back_1aa3905888cf38ed1374d1adc98c45bca6" kindref="member">send_css</ref>(path):</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>send_from_directory(</highlight><highlight class="stringliteral">&apos;css&apos;</highlight><highlight class="normal">,<sp/>path)</highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal">@app.route(</highlight><highlight class="stringliteral">&apos;/inGame/pics/&lt;path:path&gt;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="48"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespaceweb_back_1a8d2fb2f4dc56c083de514b9c0d43d7fb" kindref="member">send_pics</ref>(path):</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>send_from_directory(</highlight><highlight class="stringliteral">&apos;pics&apos;</highlight><highlight class="normal">,<sp/>path)</highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight></codeline>
<codeline lineno="51"><highlight class="normal">@app.route(</highlight><highlight class="stringliteral">&apos;/stats/pics/&lt;path:path&gt;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespaceweb_back_1a48f3c269d1d9ba6b7edf365414bbaea8" kindref="member">send_pics_stats</ref>(path):</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>send_from_directory(</highlight><highlight class="stringliteral">&apos;pics&apos;</highlight><highlight class="normal">,<sp/>path)</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight></codeline>
<codeline lineno="55"><highlight class="normal">@app.route(</highlight><highlight class="stringliteral">&apos;/js/&lt;path:path&gt;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespaceweb_back_1a36644ac58627cbb02b55457d97a7f915" kindref="member">send_js</ref>(path):</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>send_from_directory(</highlight><highlight class="stringliteral">&apos;js&apos;</highlight><highlight class="normal">,<sp/>path)</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal">@app.route(</highlight><highlight class="stringliteral">&apos;/fonts/&lt;path:path&gt;&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespaceweb_back_1adac705fce6dde6308b579f703b3b627f" kindref="member">send_fonts</ref>(path):</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>send_from_directory(</highlight><highlight class="stringliteral">&apos;fonts&apos;</highlight><highlight class="normal">,<sp/>path)</highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight><highlight class="comment">#<sp/>Client<sp/>code<sp/>consumes<sp/>like<sp/>this.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="64"><highlight class="normal">@app.route(</highlight><highlight class="stringliteral">&quot;/&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="65"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespaceweb_back_1aca1190d89e9c6bc7c6624cad8c032bb1" kindref="member">index</ref>():</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>app.send_static_file(</highlight><highlight class="stringliteral">&apos;index.html&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal">@app.route(</highlight><highlight class="stringliteral">&quot;/inGame/&lt;path:path&gt;&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespaceweb_back_1acb08cb868c656ab890c47f4a8862015b" kindref="member">inGame</ref>(path):</highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">global</highlight><highlight class="normal"><sp/>noFurtherRequests</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/>noFurtherRequests<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#print(&quot;inGame<sp/>Request&quot;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>app.send_static_file(</highlight><highlight class="stringliteral">&apos;inGame.html&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal">@app.route(</highlight><highlight class="stringliteral">&quot;/stats/&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespaceweb_back_1a251f9bc8dbc3de8ac0e0aa681388d52d" kindref="member">stats</ref>():</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>app.send_static_file(</highlight><highlight class="stringliteral">&apos;stats.html&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal">@app.route(</highlight><highlight class="stringliteral">&quot;/startInfo&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespaceweb_back_1aaf96757aed7ac16a95fea349a78f9faf" kindref="member">startInfo</ref>():</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">gen():</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>db<sp/>=<sp/>MySQLdb.connect(</highlight><highlight class="stringliteral">&quot;localhost&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;root&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;root&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;MindGame&quot;</highlight><highlight class="normal"><sp/>)</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dbc<sp/>=<sp/>db.cursor()</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#update<sp/>highscore<sp/>section</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sql<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;SELECT<sp/>Name,<sp/>Score<sp/>FROM<sp/>Highscore<sp/>order<sp/>by<sp/>Score<sp/>desc<sp/>limit<sp/>5&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dbc.execute(sql)</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>results<sp/>=<sp/>dbc.fetchall()</highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;{&quot;highscore&quot;:<sp/>[&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>row<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>results:</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;{&quot;Name&quot;:<sp/>&quot;%s&quot;,<sp/>&quot;Score&quot;:<sp/>&quot;%s&quot;},&apos;</highlight><highlight class="normal"><sp/>%<sp/>(row[0],<sp/>row[1])</highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>result.endswith(</highlight><highlight class="stringliteral">&quot;[&quot;</highlight><highlight class="normal">)):</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>result[:-1]</highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=</highlight><highlight class="stringliteral">&apos;]}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sendResult<sp/>=<sp/><ref refid="classweb_back_1_1_server_sent_event" kindref="compound">ServerSentEvent</ref>(1,</highlight><highlight class="stringliteral">&quot;highscore&quot;</highlight><highlight class="normal">,<sp/>str(result),<sp/></highlight><highlight class="stringliteral">&quot;1000&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">yield</highlight><highlight class="normal"><sp/>sendResult.encode()</highlight></codeline>
<codeline lineno="100"><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#update<sp/>Game<sp/>section</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sql<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;SELECT<sp/>Gamename<sp/>FROM<sp/>Game<sp/>limit<sp/>5&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dbc.execute(sql)</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>results<sp/>=<sp/>dbc.fetchall()</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;{&quot;Games&quot;:<sp/>[&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>boolrunning<sp/>=<sp/>__main__.go.p1.time<sp/>&gt;<sp/>0<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>__main__.go.p2.time<sp/>&gt;<sp/>0</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>row<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>results:</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;{&quot;Gamename&quot;:<sp/>&quot;%s&quot;,<sp/>&quot;Running&quot;:<sp/>&quot;%s&quot;},&apos;</highlight><highlight class="normal"><sp/>%<sp/>(row[0],<sp/>str(boolrunning))</highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>result.endswith(</highlight><highlight class="stringliteral">&quot;[&quot;</highlight><highlight class="normal">)):</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>result[:-1]</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=</highlight><highlight class="stringliteral">&apos;]}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sendResult<sp/>=<sp/><ref refid="classweb_back_1_1_server_sent_event" kindref="compound">ServerSentEvent</ref>(1,</highlight><highlight class="stringliteral">&quot;Game&quot;</highlight><highlight class="normal">,<sp/>str(result),<sp/></highlight><highlight class="stringliteral">&quot;1000&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">yield</highlight><highlight class="normal"><sp/>sendResult.encode()</highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#print<sp/>&quot;info<sp/>send&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Response(gen(),<sp/>mimetype=</highlight><highlight class="stringliteral">&quot;text/event-stream&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="118"><highlight class="normal"></highlight></codeline>
<codeline lineno="119"><highlight class="normal">@app.route(</highlight><highlight class="stringliteral">&quot;/inGameInfo/&lt;path:path&gt;&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespaceweb_back_1a586d6d3a74f2479f390486276186a626" kindref="member">gameInfo</ref>(path):</highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">gen(game):</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__main__.gameRunning<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">global</highlight><highlight class="normal"><sp/>noFurtherRequests</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noFurtherRequests<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#playerinfo</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;{&quot;players&quot;:[{&quot;name&quot;:<sp/>&quot;&apos;</highlight><highlight class="normal"><sp/>+<sp/>__main__.go.getPlayer1Name()<sp/></highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;&quot;,<sp/>&quot;time&quot;:&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(__main__.go.p1.time)<sp/>+</highlight><highlight class="stringliteral">&apos;,<sp/>&quot;maxTime&quot;:<sp/>&apos;</highlight><highlight class="normal">+<sp/>str(__main__.go.p1.maxTime)<sp/>+</highlight><highlight class="stringliteral">&apos;,<sp/>&quot;stress&quot;:<sp/>&apos;</highlight><highlight class="normal">+<sp/>str(__main__.go.p1.stress)<sp/></highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;,<sp/>&quot;balls&quot;:<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(__main__.go.p1.balls)</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;,<sp/>&quot;points&quot;:<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(__main__.go.p1.points)<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;},&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;{&quot;name&quot;:<sp/>&quot;&apos;</highlight><highlight class="normal"><sp/>+<sp/>__main__.go.getPlayer2Name()</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;&quot;,<sp/>&quot;time&quot;:&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(__main__.go.p2.time)<sp/>+</highlight><highlight class="stringliteral">&apos;,<sp/>&quot;maxTime&quot;:<sp/>&apos;</highlight><highlight class="normal">+<sp/>str(__main__.go.p2.maxTime)+<sp/></highlight><highlight class="stringliteral">&apos;,<sp/>&quot;stress&quot;:<sp/>&apos;</highlight><highlight class="normal">+<sp/>str(__main__.go.p2.stress)</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;,<sp/>&quot;balls&quot;:<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(__main__.go.p2.balls)</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;,<sp/>&quot;points&quot;:<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(__main__.go.p2.points)<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;}]}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="classweb_back_1_1_server_sent_event" kindref="compound">ServerSentEvent</ref>(1,</highlight><highlight class="stringliteral">&quot;playerInfo&quot;</highlight><highlight class="normal">,<sp/>str(result),<sp/></highlight><highlight class="stringliteral">&quot;300&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">yield</highlight><highlight class="normal"><sp/>result.encode()</highlight></codeline>
<codeline lineno="136"><highlight class="normal"></highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#countdown</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>__main__.go.countdown</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sendResult<sp/>=<sp/><ref refid="classweb_back_1_1_server_sent_event" kindref="compound">ServerSentEvent</ref>(1,</highlight><highlight class="stringliteral">&quot;countdown&quot;</highlight><highlight class="normal">,<sp/>str(result),<sp/></highlight><highlight class="stringliteral">&quot;300&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">yield</highlight><highlight class="normal"><sp/>sendResult.encode()</highlight></codeline>
<codeline lineno="141"><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#debugging</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;{&quot;debugging&quot;:[{&quot;line&quot;:<sp/>&quot;&apos;</highlight><highlight class="normal"><sp/>+<sp/>__main__.go.getPlayer1Name()<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;<sp/>time<sp/>&apos;</highlight><highlight class="normal">+<sp/>str(__main__.go.p1.time)<sp/>+</highlight><highlight class="stringliteral">&apos;<sp/>maxTime<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(__main__.go.p1.maxTime)<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;<sp/>Points<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(__main__.go.p1.points)<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;&quot;}]}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/><ref refid="classweb_back_1_1_server_sent_event" kindref="compound">ServerSentEvent</ref>(1,</highlight><highlight class="stringliteral">&quot;debug&quot;</highlight><highlight class="normal">,<sp/>str(result),<sp/></highlight><highlight class="stringliteral">&quot;300&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">yield</highlight><highlight class="normal"><sp/>result.encode()</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Response(gen(path),<sp/>mimetype=</highlight><highlight class="stringliteral">&quot;text/event-stream&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="147"><highlight class="normal"></highlight></codeline>
<codeline lineno="148"><highlight class="normal"></highlight></codeline>
<codeline lineno="149"><highlight class="normal">@app.route(</highlight><highlight class="stringliteral">&quot;/stopGame&quot;</highlight><highlight class="normal">,<sp/>methods=[</highlight><highlight class="stringliteral">&apos;POST&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="150"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespaceweb_back_1a0514aabed091ee5e2f35766eb01eced6" kindref="member">debug</ref>():</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">stopwait(gamename):</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;stopGame<sp/>called&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>time.sleep(2)</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noFurtherRequests<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>time.sleep(2)</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">global</highlight><highlight class="normal"><sp/>noFurtherRequests</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(noFurtherRequests<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>__main__.go.p1.time<sp/>&gt;<sp/>0<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>__main__.go.p2.time<sp/>&gt;<sp/>0):</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#print(<sp/>__main__.go.p1.time)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>db<sp/>=<sp/>MySQLdb.connect(</highlight><highlight class="stringliteral">&quot;localhost&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;root&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;root&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;MindGame&quot;</highlight><highlight class="normal"><sp/>)</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dbc<sp/>=<sp/>db.cursor()</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sql<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;DELETE<sp/>FROM<sp/>Game<sp/>WHERE<sp/>Gamename<sp/>=<sp/>&apos;&quot;</highlight><highlight class="normal"><sp/>+<sp/>gamename<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;&apos;;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(sql)</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dbc.execute(sql)</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>db.commit()</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__main__.gameRunning<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noFurtherRequests<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;not<sp/>stopping<sp/>the<sp/>game&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="169"><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#def<sp/>printReq():</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>while<sp/>True:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>global<sp/>noFurtherRequests</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(&quot;request:<sp/>%s&quot;<sp/>%(noFurtherRequests))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>time.sleep(1)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#printreqThread<sp/>=<sp/>Thread(target<sp/>=<sp/>printReq,<sp/>args<sp/>=<sp/>())</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#if(not<sp/>printreqThread.isAlive()):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>printreqThread.start()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/>stopWaitThread<sp/>=<sp/>Thread(target<sp/>=<sp/>stopwait,<sp/>args<sp/>=<sp/>(str(request.form[</highlight><highlight class="stringliteral">&apos;gn&apos;</highlight><highlight class="normal">]),))</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/>if(</highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>stopWaitThread.isAlive()):</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stopWaitThread.start()</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;ok&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal">@app.route(</highlight><highlight class="stringliteral">&quot;/startGame&quot;</highlight><highlight class="normal">,<sp/>methods=[</highlight><highlight class="stringliteral">&apos;POST&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="185"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespaceweb_back_1a5f030b0ffd219cb8152121a951e8767a" kindref="member">startgame</ref>():</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>request.method<sp/>==<sp/></highlight><highlight class="stringliteral">&apos;POST&apos;</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#print(&quot;login!&quot;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#print(request.form)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>db<sp/>=<sp/>MySQLdb.connect(</highlight><highlight class="stringliteral">&quot;localhost&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;root&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;root&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;MindGame&quot;</highlight><highlight class="normal"><sp/>)</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dbc<sp/>=<sp/>db.cursor()</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sql<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;SELECT<sp/>Gamename<sp/>FROM<sp/>Game<sp/>where<sp/>Gamename<sp/>=<sp/>&apos;&quot;</highlight><highlight class="normal"><sp/>+<sp/>request.form[</highlight><highlight class="stringliteral">&apos;gn&apos;</highlight><highlight class="normal">]<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;&apos;;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dbc.execute(sql)</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordflow">not</highlight><highlight class="normal"><sp/>dbc.fetchall()<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>__main__.gameRunning<sp/>==<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sql<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;INSERT<sp/>INTO<sp/>Game<sp/>(Gamename,<sp/>P1Name,<sp/>P2Name,<sp/>passwd,<sp/>gameMode,<sp/>lightMode)<sp/>VALUES<sp/>(&apos;&quot;</highlight><highlight class="normal"><sp/>+<sp/>request.form[</highlight><highlight class="stringliteral">&apos;gn&apos;</highlight><highlight class="normal">]<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;&apos;,<sp/>&apos;&quot;</highlight><highlight class="normal"><sp/>+<sp/>request.form[</highlight><highlight class="stringliteral">&apos;p1n&apos;</highlight><highlight class="normal">]<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;&apos;,<sp/>&apos;&quot;</highlight><highlight class="normal">+<sp/>request.form[</highlight><highlight class="stringliteral">&apos;p2n&apos;</highlight><highlight class="normal">]<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;&apos;,<sp/>&apos;&quot;</highlight><highlight class="normal">+<sp/>request.form[</highlight><highlight class="stringliteral">&apos;pw&apos;</highlight><highlight class="normal">]<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;&apos;,<sp/>&apos;&quot;</highlight><highlight class="normal">+<sp/>request.form[</highlight><highlight class="stringliteral">&apos;gm&apos;</highlight><highlight class="normal">]<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;&apos;,<sp/>&apos;&quot;</highlight><highlight class="normal">+<sp/>request.form[</highlight><highlight class="stringliteral">&apos;lm&apos;</highlight><highlight class="normal">]<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;&apos;);&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#print(sql)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dbc.execute(sql)</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>db.commit()</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__main__.gameRunning<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>db<sp/>=<sp/>MySQLdb.connect(</highlight><highlight class="stringliteral">&quot;localhost&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;root&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;root&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;MindGame&quot;</highlight><highlight class="normal"><sp/>)</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dbc<sp/>=<sp/>db.cursor()</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sql<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;SELECT<sp/>P1Name,<sp/>P2Name,<sp/>gameMode,<sp/>lightMode<sp/>FROM<sp/>Game<sp/>where<sp/>Gamename<sp/>=<sp/>&apos;&quot;</highlight><highlight class="normal"><sp/>+<sp/>request.form[</highlight><highlight class="stringliteral">&apos;gn&apos;</highlight><highlight class="normal">]<sp/>+<sp/></highlight><highlight class="stringliteral">&quot;&apos;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#print(sql)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dbc.execute(sql)</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>results<sp/>=<sp/>dbc.fetchall()</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#print(results)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>row<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>results:</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p1<sp/>=<sp/>row[0]</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p2<sp/>=<sp/>row[1]</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#if(row[2]<sp/>==<sp/>&quot;easy&quot;):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>startTime<sp/>=<sp/>160</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#elif(row[2]==&quot;normal&quot;):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>startTime<sp/>=<sp/>120</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#elif(row[2]==&quot;hard&quot;):</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/><sp/><sp/><sp/>startTime<sp/>=<sp/>90</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__main__.go<sp/>=<sp/><ref refid="classgame_1_1game_1_1_game" kindref="compound">Game</ref>(p1,p2,row[2],row[3])</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>__main__.go.startGame()</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;ok&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">elif</highlight><highlight class="normal"><sp/>(__main__.gameRunning<sp/>==<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;gameRunning...&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;gameRunning&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(</highlight><highlight class="stringliteral">&quot;nameExist...&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;nameExist&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="224"><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"></highlight></codeline>
<codeline lineno="226"><highlight class="normal">@app.route(</highlight><highlight class="stringliteral">&quot;/statInfo&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="227"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespaceweb_back_1a37f3ed1601cc23aa04e72ebf237ba3c5" kindref="member">statinfo</ref>():</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal">gen():</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#print(&quot;statInfo<sp/>called&quot;)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#HOLESTAT<sp/>INFO</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>db<sp/>=<sp/>MySQLdb.connect(</highlight><highlight class="stringliteral">&quot;localhost&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;root&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;root&quot;</highlight><highlight class="normal">,</highlight><highlight class="stringliteral">&quot;MindGame&quot;</highlight><highlight class="normal"><sp/>)</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dbc<sp/>=<sp/>db.cursor()</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sql<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;SELECT<sp/>sum(Hole1),<sp/>sum(Hole2),<sp/>sum(Hole3),<sp/>sum(Hole4),<sp/>sum(Hole5),<sp/>sum(Hole6),<sp/>sum(Hole7),<sp/>sum(Hole8)<sp/>FROM<sp/>MindGame.Holestats;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dbc.execute(sql)</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>results<sp/>=<sp/>dbc.fetchall()</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>row<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>results:</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;{&quot;Holes&quot;:[{&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(8):</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;&quot;hole&apos;</highlight><highlight class="normal">+str(i+1)+</highlight><highlight class="stringliteral">&apos;&quot;:<sp/>&quot;&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(row[i])<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;&quot;,<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/>result[:-2]</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result+=</highlight><highlight class="stringliteral">&apos;}]}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sendResult<sp/>=<sp/><ref refid="classweb_back_1_1_server_sent_event" kindref="compound">ServerSentEvent</ref>(1,</highlight><highlight class="stringliteral">&quot;holeStat&quot;</highlight><highlight class="normal">,<sp/>str(result),<sp/></highlight><highlight class="stringliteral">&quot;15000&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">yield</highlight><highlight class="normal"><sp/>sendResult.encode()</highlight></codeline>
<codeline lineno="244"><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#POINTS<sp/>INFO</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sql<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;Select(SELECT<sp/>round(avg(Score),2)<sp/>FROM<sp/>MindGame.Highscore<sp/>where<sp/>GameMode<sp/>=<sp/>&quot;easy&quot;<sp/>and<sp/>LightMode<sp/>=<sp/>&quot;subtile&quot;)<sp/>as<sp/>easy_subtile,(SELECT<sp/>round(avg(Score),2)<sp/>FROM<sp/>MindGame.Highscore<sp/>where<sp/>GameMode<sp/>=<sp/>&quot;normal&quot;<sp/><sp/>and<sp/>LightMode<sp/>=<sp/>&quot;subtile&quot;)<sp/>as<sp/>normal_subtile,(SELECT<sp/>round(avg(Score),2)<sp/>FROM<sp/>MindGame.Highscore<sp/>where<sp/>GameMode<sp/>=<sp/>&quot;hard&quot;<sp/><sp/>and<sp/>LightMode<sp/>=<sp/>&quot;subtile&quot;)<sp/>as<sp/>hard_subtile,(SELECT<sp/>round(avg(Score),2)<sp/>FROM<sp/>MindGame.Highscore<sp/>where<sp/>GameMode<sp/>=<sp/>&quot;easy&quot;<sp/>and<sp/>LightMode<sp/>=<sp/>&quot;extreme&quot;)<sp/>as<sp/>easy_extreme,(SELECT<sp/>round(avg(Score),2)<sp/>FROM<sp/>MindGame.Highscore<sp/>where<sp/>GameMode<sp/>=<sp/>&quot;normal&quot;<sp/><sp/>and<sp/>LightMode<sp/>=<sp/>&quot;extreme&quot;)<sp/>as<sp/>normal_extreme,(SELECT<sp/>round(avg(Score),2)<sp/>FROM<sp/>MindGame.Highscore<sp/>where<sp/>GameMode<sp/>=<sp/>&quot;hard&quot;<sp/><sp/>and<sp/>LightMode<sp/>=<sp/>&quot;extreme&quot;)<sp/>as<sp/>hard_extreme<sp/>from<sp/>MindGame.Highscore<sp/>limit<sp/>1;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dbc.execute(sql)</highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>results<sp/>=<sp/>dbc.fetchall()</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>row<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>results:</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;{&quot;averages&quot;:[{&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;&quot;easy_subtile&quot;:<sp/>&quot;&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(row[0])<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;&quot;,<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;&quot;normal_subtile&quot;:<sp/>&quot;&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(row[1])<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;&quot;,<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;&quot;hard_subtile&quot;:<sp/>&quot;&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(row[2])<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;&quot;,<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;&quot;easy_extreme&quot;:<sp/>&quot;&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(row[3])<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;&quot;,<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;&quot;normal_extreme&quot;:<sp/>&quot;&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(row[4])<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;&quot;,<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;&quot;hard_extreme&quot;:<sp/>&quot;&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(row[5])<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;&quot;}]}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sendResult<sp/>=<sp/><ref refid="classweb_back_1_1_server_sent_event" kindref="compound">ServerSentEvent</ref>(1,</highlight><highlight class="stringliteral">&quot;pointsStat&quot;</highlight><highlight class="normal">,<sp/>str(result),<sp/></highlight><highlight class="stringliteral">&quot;15000&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">yield</highlight><highlight class="normal"><sp/>sendResult.encode()</highlight></codeline>
<codeline lineno="260"><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#HART<sp/>INFO</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sql<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;select(select<sp/>round(avg(BPM),2)<sp/>from<sp/>MindGame.Hartstats<sp/>where<sp/>R<sp/>=<sp/>255<sp/>and<sp/>G<sp/>=<sp/>0<sp/>and<sp/>B<sp/>=<sp/>0)<sp/>as<sp/>red,(select<sp/>round(avg(BPM),2)<sp/>from<sp/>MindGame.Hartstats<sp/>where<sp/>R<sp/>=<sp/>0<sp/>and<sp/>G<sp/>=<sp/>255<sp/>and<sp/>B<sp/>=<sp/>0)<sp/>as<sp/>green,(select<sp/>round(avg(BPM),2)<sp/>from<sp/>MindGame.Hartstats<sp/>where<sp/>R<sp/>=<sp/>0<sp/>and<sp/>G<sp/>=<sp/>0<sp/>and<sp/>B<sp/>=<sp/>255)<sp/>as<sp/>blue<sp/>from<sp/>MindGame.Hartstats<sp/>limit<sp/>1;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dbc.execute(sql)</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>results<sp/>=<sp/>dbc.fetchall()</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>row<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>results:</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>=<sp/></highlight><highlight class="stringliteral">&apos;{&quot;Hart&quot;:[{&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;&quot;Red&quot;:<sp/>&quot;&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(row[0])<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;&quot;,<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;&quot;Green&quot;:<sp/>&quot;&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(row[1])<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;&quot;,<sp/>&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>result<sp/>+=<sp/></highlight><highlight class="stringliteral">&apos;&quot;Blue&quot;:<sp/>&quot;&apos;</highlight><highlight class="normal"><sp/>+<sp/>str(row[2])<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;&quot;}]}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sendResult<sp/>=<sp/><ref refid="classweb_back_1_1_server_sent_event" kindref="compound">ServerSentEvent</ref>(1,</highlight><highlight class="stringliteral">&quot;hartsStat&quot;</highlight><highlight class="normal">,<sp/>str(result),<sp/></highlight><highlight class="stringliteral">&quot;15000&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">yield</highlight><highlight class="normal"><sp/>sendResult.encode()</highlight></codeline>
<codeline lineno="273"><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"></highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Response(gen(),<sp/>mimetype=</highlight><highlight class="stringliteral">&quot;text/event-stream&quot;</highlight><highlight class="normal">)</highlight></codeline>
    </programlisting>
    <location file="/home/pieter-jan/Dropbox/School/2016-2017/Embedded prototyping/Python/webBack.py"/>
  </compounddef>
</doxygen>
